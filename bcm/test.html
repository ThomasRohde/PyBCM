<!DOCTYPE html>
<html>
<head>
    <style>
        .card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            margin: 1rem;
            max-width: 100%;
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1a202c;
        }

        .card-content {
            padding: 1.5rem;
            overflow: auto;
        }

        svg text {
            font-family: system-ui, -apple-system, sans-serif;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .bg-white {
            background: white;
        }

        /* Add styles for SVG tooltips */
        .capability-tooltip {
            font-family: system-ui, -apple-system, sans-serif;
            font-size: 0.75rem;
            pointer-events: none;
        }

        /* Update tooltip styles */
        title {
            font-family: system-ui, -apple-system, sans-serif;
            font-size: 14px;
        }

        /* Tooltip styles */
        svg {
            pointer-events: none; /* Ensure tooltips work on child elements */
        }
        
        g, rect {
            pointer-events: all;
        }

        g:hover, rect:hover {
            /* Reduce delay before tooltip appears */
            transition-delay: 0s;
            transition-duration: 0s;
        }
    </style>
</head>
<body>
    <div class="card">
        <div class="card-content">
            <div id="svg-container"></div>
        </div>
    </div>

    <script>
        // Constants
        const BOX_MIN_WIDTH = 120;
        const BOX_MIN_HEIGHT = 60;
        const HORIZONTAL_GAP = 20;
        const VERTICAL_GAP = 20;
        const PADDING = 30;
        const DEFAULT_TARGET_ASPECT_RATIO = 1.0;
        const LINE_HEIGHT = 16; // Height of each text line
        const PADDING_TOP = 10; // Padding from top of box to text

        // Sample data with descriptions
        const capabilityModel = {"name": "Danske Bank Organisation", "description": "# Overview of Danske Bank\n\nDanske Bank is a leading Nordic bank with a strong international presence. The bank offers a wide range of financial products and services to personal and business customers in Denmark, Finland, Norway, Sweden, and Northern Ireland1. This report provides a detailed overview of Danske Bank's current business activities, including its IT infrastructure and systems, to support the development of a business capability mode.\n\n## Business Overview\n\nDanske Bank is a financial services group headquartered in Copenhagen, Denmark. Founded in 1871, the bank has grown to become a major player in the Nordic banking market. Danske Bank is committed to providing its customers with a wide range of financial products and services, including:\n\nBanking: Checking and savings accounts, loans, mortgages, and cards.\n\nInvesting: Mutual funds, stocks, bonds, and retirement planning.\n\nInsurance: Auto, home, life, and health insurance.\n\nBusiness Banking: A comprehensive suite of banking solutions tailored to the needs of businesses, including checking and savings accounts, loans, and cards.\n\nDanske Bank is also focused on sustainability and has a dedicated section on its website that provides information about its strategic direction, offerings, publications, and policies related to environmental, social, and governance (ESG) factors. In addition, the bank is actively working to reduce costs and improve efficiency as part of its overall strategy.\n\n### Financial Performance\n\nDanske Bank has demonstrated strong financial performance in recent years. In 2023, the bank reported a total income of 52.45 kr. billion and operating expenses of around 25.8 billion. The bank also reported a number of one-off items, including transaction costs related to the sale of its personal customer business in Norway, a gain from the sale of shares, and interest compensation related to a tax decision. \n\n## IT Infrastructure and Systems\n\nDanske Bank is committed to investing in digitalization and cloud technology to enhance its customer experience and operational efficiency. The bank has stated its ambition to be a \"leading bank in a digital age.\" To achieve this, Danske Bank has undertaken a significant IT transformation initiative, including a multi-year agreement with Amazon Web Services (AWS) to migrate selected infrastructure, applications, and data to the cloud. This migration involves:\n\nCloud Migration: Transferring over 16,600 virtual and physical servers and more than 1,000 applications from Danske Bank's private cloud to AWS6. Notably, Danske Bank aims to complete this migration faster than the typical 5-8 years for organizations of their size.\n\nDigital Transformation: Leveraging AWS's cloud technologies, including artificial intelligence (AI) and machine learning, to develop new digital solutions and improve customer service.\n\nHyperautomation: Implementing AWS technologies to automate processes and improve efficiency.\n\nCore Banking Systems: Continuing to run core banking and customer information systems on the IBM Z platform, using two IBM z16 mainframes in an ultra-high-availability GDPS cluster.\n\nTo support this transition, Danske Bank is investing in training its employees on AWS cloud technologies. The bank plans to provide AWS training to more than 1,500 employees and embed cloud skills into management courses to accelerate cloud adoption.\n\nDanske Bank has an extensive software development capability.\n\n## Investor Relations\n\nDanske Bank provides comprehensive information for investors through its Investor Relations section on its website. This section includes detailed information about the bank's financial performance, strategy, and governance1. Key resources available to investors include:\n\nShares: Information about Danske Bank's share price, dividends, and shareholder structure1.\n\nShare Buy-back Program: Danske Bank has an active share buy-back program. As of December 20, 2024, the bank had repurchased a total of 25,708,740 shares with a gross value of 5,188,068,766 DKK10.\n\nReports: Access to the bank's annual reports, interim reports, and other financial publications.\n\nRegulation: Information about the regulatory environment in which Danske Bank operates.\n\nDebt: Details about the bank's debt issuances and credit ratings.\n\n## Careers\n\nDanske Bank offers a variety of career opportunities across different functions and locations. The bank's Careers section on its website provides information about the different career paths available, including:\n\nJoining us: Information about the recruitment process and the types of roles available at Danske Bank.\n\nLeaders: Insights into the bank's leadership team and their vision for the future.\n\nIT Professionals: Opportunities for IT professionals to contribute to the bank's technology initiatives.\n\nBusiness Professionals: Roles for professionals with expertise in areas such as finance, risk management, and customer service.\n\n## News and Reports\n\nDanske Bank actively communicates its news and updates through various channels, including press releases, news articles, and company announcements. These sources provide valuable insights into the bank's current business activities and strategic direction.\n\n### Financial Performance and Strategic Updates\n\nProfit Upgrade: Danske Bank revised its 2024 net profit outlook upwards, driven by an improving macroeconomic environment, good customer activity, and strong credit quality. This highlights the bank's positive financial performance and its ability to adapt to changing market conditions.\n\nNordic Outlook: Danske Bank's economic research team published a report on the Nordic economic outlook, highlighting the potential benefits of lower interest rates and increased spending power. This demonstrates the bank's expertise in economic analysis and its commitment to providing valuable insights to its clients and stakeholders.\n\n### Sustainability Initiatives\n\nRural Housing Association Funding: Danske Bank provided a \u00a325 million funding package to the Rural Housing Association to support the development of over 300 homes.\n\nYoung Enterprise Biodiversity Programme: Danske Bank partnered with Young Enterprise to launch a new biodiversity program for schools.\n\nGreen Leadership Recognition: Danske Bank was recognized for its environmental leadership in an annual survey report, achieving Platinum status.\n\nThese initiatives demonstrate Danske Bank's commitment to sustainability and its efforts to support environmental and social causes.\n\n## Conclusion\n\nDanske Bank is a leading financial institution with a strong commitment to providing a wide range of financial products and services to its customers1. The bank is actively investing in digitalization and cloud technology to enhance its customer experience and operational efficiency5. This analysis of Danske Bank has provided a detailed overview of its current business activities, including its IT infrastructure and systems, which can be used to develop a comprehensive business capability model.\n\nThis model can help to identify and analyze the bank's key business capabilities, enabling it to optimize its operations and achieve its strategic goals. For example, the information presented in this report can be used to define capabilities such as:\n\nCustomer Relationship Management: This capability encompasses all the activities related to acquiring, serving, and retaining customers. It includes functions such as marketing, sales, customer service, and customer onboarding.\n\nProduct Development: This capability involves the design, development, and launch of new financial products and services. It includes activities such as market research, product design, and product testing.\n\nRisk Management: This capability focuses on identifying, assessing, and mitigating risks across the bank's operations. It includes functions such as credit risk management, market risk management, and operational risk management.\n\nIT Management: This capability encompasses all the activities related to managing the bank's IT infrastructure and systems. It includes functions such as infrastructure management, application development, and cybersecurity.\n\nBy developing a clear understanding of its key business capabilities, Danske Bank can ensure that it has the right resources and processes in place to meet its strategic objectives. Furthermore, the bank's commitment to both sustainability and financial performance 11 suggests a balanced approach to business that considers both profitability and social responsibility. This approach can be integrated into the business capability model to ensure that sustainability is considered in all aspects of the bank's operations.", "children": [{"name": "Customer Relationship Management", "description": "Manage interactions with customers to enhance satisfaction, loyalty, and long-term engagement through effective marketing, sales, and service strategies.", "children": [{"name": "Customer Acquisition Management", "description": "Oversee the strategies and processes focused on attracting and acquiring new customers, including lead generation, outreach, and conversion activities to enhance the customer base.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Engagement Management", "description": "Develop and implement strategies to foster ongoing engagement with customers, ensuring that interactions are meaningful and personalized to enhance customer experience and loyalty.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Service Optimization", "description": "Enhance customer satisfaction by streamlining customer service processes, utilizing feedback, and implementing best practices to resolve issues efficiently and effectively.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Retention Strategies", "description": "Design and manage initiatives aimed at retaining existing customers, reducing churn rates through loyalty programs, targeted communication, and value-added services.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Insights and Analytics", "description": "Utilize data analytics to gain insights into customer behavior, preferences, and trends, enabling informed decision-making and tailored service offerings.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Brand Relationship Management", "description": "Establish and maintain brand perception among customers through consistent messaging and valuation of customer feedback, reinforcing brand loyalty and trust.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Multi-Channel Communication Management", "description": "Manage and coordinate customer interactions across various communication channels (e.g., email, social media, phone) to ensure consistent and responsive communication.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Feedback and Improvement Programs", "description": "Implement mechanisms for collecting and analyzing customer feedback, using insights to drive continuous improvements in products and services.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Onboarding Experience Management", "description": "Facilitate a seamless onboarding process for new customers, ensuring they understand services and are set up for successful engagement from the outset.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Sales Enablement and Support", "description": "Provide teams with the tools, resources, and information necessary to effectively sell to customers, including training, materials, and customer relationship tools.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Product Development", "description": "Design, develop, and launch innovative financial products and services while conducting market research to ensure alignment with customer needs.", "children": [{"name": "Market Research Management", "description": "Market Research Management focuses on gathering and analyzing market data to identify customer needs and trends. This sub-capability ensures that product development efforts are data-driven and aligned with market demands, enabling the creation of products that resonate with target audiences.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Product Design and Prototyping", "description": "Product Design and Prototyping involves creating product concepts and developing prototypes to validate ideas before full-scale production. This sub-capability streamlines the design process and fosters innovation, allowing teams to iterate and refine products based on user feedback.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Regulatory Compliance Integration", "description": "Regulatory Compliance Integration ensures that all new financial products and services meet required regulations and standards. This sub-capability minimizes risk by incorporating compliance considerations into the product development lifecycle, providing assurance that offerings are legally sound.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Product Testing and Validation", "description": "Product Testing and Validation is the process of rigorously assessing new products to ensure they meet performance, usability, and reliability standards. This sub-capability provides critical insights through testing, reducing the likelihood of product failures post-launch and enhancing customer satisfaction.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Product Launch Management", "description": "Product Launch Management oversees the strategic introduction of new products to the market. This sub-capability encompasses planning, marketing, and execution efforts that align with business objectives, maximizing visibility and adoption while tracking launch success.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Post-Launch Evaluation", "description": "Post-Launch Evaluation assesses the performance and reception of newly launched products. This sub-capability gathers feedback and analyzes key performance indicators to determine product success, supporting continuous improvement and informing future product initiatives.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Portfolio Management", "description": "Portfolio Management involves the strategic oversight of the bank's entire product portfolio, ensuring an optimal mix of offerings that aligns with business goals and market opportunities. This sub-capability facilitates informed decision-making about product development priorities and resource allocation.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Feedback Integration", "description": "Customer Feedback Integration systematically collects and analyzes input from users to shape product enhancements and new development efforts. This sub-capability strengthens customer engagement and ensures that products continue to meet evolving needs, fostering loyalty and satisfaction.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Agile Development Practices", "description": "Agile Development Practices instill flexibility and responsiveness in the product development process, allowing teams to adapt quickly to changes and feedback. This sub-capability promotes iterative development and collaboration, resulting in faster time-to-market and improved alignment with customer expectations.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Innovation Management", "description": "Innovation Management fosters a culture of creativity within the product development team by encouraging new ideas and approaches. This sub-capability drives the exploration of novel solutions that can enhance the bank's product offerings, ensuring competitiveness in a rapidly changing market.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Risk Management", "description": "Identify, assess, and mitigate various forms of risk, including credit, market, and operational risks, to protect the bank's assets and ensure compliance.", "children": [{"name": "Credit Risk Assessment", "description": "Credit Risk Assessment involves evaluating the creditworthiness of borrowers and potential counterparties to inform lending decisions. This sub-capability focuses on analyzing financial data, assessing repayment capacity, and determining the risk of default, thereby protecting the bank's interests and enhancing profitability.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Market Risk Management", "description": "Market Risk Management entails identifying, measuring, and mitigating risks associated with fluctuations in market prices, interest rates, and currency values. This sub-capability aims to minimize potential losses from adverse market movements, ensuring the bank's financial stability and maintaining investor confidence.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Operational Risk Management", "description": "Operational Risk Management encompasses the identification and mitigation of risks arising from internal processes, systems, or personnel. This sub-capability is designed to safeguard the bank's operations from potential disruptions, enhancing resilience and maintaining compliance with regulatory standards.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Compliance Risk Monitoring", "description": "Compliance Risk Monitoring focuses on ensuring adherence to relevant regulatory requirements, industry standards, and internal policies. This sub-capability aims to identify compliance gaps and implement measures to mitigate risks associated with non-compliance, thereby protecting the bank's reputation.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Risk Reporting and Communication", "description": "Risk Reporting and Communication involves the systematic collection, analysis, and presentation of risk-related data to stakeholders. This sub-capability enhances transparency and informed decision-making by providing timely insights into risk exposure, thereby facilitating proactive risk management.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Insurance and Risk Transfer", "description": "Insurance and Risk Transfer refers to the evaluation and acquisition of insurance products to mitigate various risks faced by the bank. This sub-capability aims to manage potential financial impacts from unforeseen events, ensuring business continuity and protecting assets.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Risk Assessment and Framework Development", "description": "Risk Assessment and Framework Development entails establishing methodologies and frameworks for identifying, quantifying, and prioritizing risks. This sub-capability supports consistent risk management practices across the organization, aligning risk strategies with business objectives.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Scenario Analysis and Stress Testing", "description": "Scenario Analysis and Stress Testing involves evaluating the potential impact of extreme but plausible events on the bank's financial position. This sub-capability is essential for understanding vulnerabilities and guiding strategic responses, ensuring that the bank is prepared for unexpected market conditions.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Risk Culture and Awareness Training", "description": "Risk Culture and Awareness Training focuses on fostering a risk-aware culture within the organization through targeted education programs. This sub-capability aims to empower employees with knowledge and tools to identify and manage risks proactively, enhancing overall risk governance.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Risk Mitigation Strategy Development", "description": "Risk Mitigation Strategy Development formulates and implements strategies to minimize identified risks' impact. This sub-capability ensures that the bank has actionable plans in place to address risks effectively, supporting overall business resilience and performance.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "IT Infrastructure Management", "description": "Oversee the bank's IT infrastructure, including cloud systems, cybersecurity, and application development, to ensure reliable and secure operations.", "children": [{"name": "Cloud Infrastructure Management", "description": "Manage and optimize the bank's cloud infrastructure, ensuring the efficient deployment and operation of cloud resources. This sub-capability focuses on monitoring cloud performance, cost control, and maintaining operational reliability to support the bank's digital transformation goals.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Cybersecurity Management", "description": "Implement and oversee cybersecurity measures to protect the bank\u2019s IT infrastructure from threats and vulnerabilities. This sub-capability is dedicated to ensuring the confidentiality, integrity, and availability of critical systems and data, thereby safeguarding stakeholder interests.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Application Lifecycle Management", "description": "Oversee the entire lifecycle of IT applications, from planning and development to deployment and sunset. This sub-capability ensures applications align with business objectives and deliver value while adhering to regulatory requirements and quality standards.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Network Operations Management", "description": "Administer and maintain the bank's network infrastructure to ensure seamless connectivity and communication across all IT systems. This sub-capability focuses on optimizing network performance, reliability, and security, ultimately enhancing overall operational efficiency.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Data Center Operations Management", "description": "Manage the physical and virtual environments of the bank\u2019s data centers, ensuring optimal performance, reliability, and scalability. This sub-capability integrates infrastructure monitoring, resource allocation, and energy efficiency practices to support business continuity.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Disaster Recovery and Business Continuity Planning", "description": "Develop and maintain disaster recovery and business continuity plans to ensure the bank's IT infrastructure can swiftly recover from disruptions. This sub-capability aims to minimize downtime and data loss, thereby protecting customer trust and regulatory compliance.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "IT Asset Management", "description": "Oversee and manage inventory of IT assets, including hardware, software, and licenses. This sub-capability ensures efficient utilization of resources, cost control, and compliance with industry regulations regarding asset lifecycle.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "IT Service Management", "description": "Implement and maintain IT service management practices to ensure the delivery of high-quality IT services that meet business needs. This sub-capability focuses on processes such as incident management, problem management, and service desk operations to enhance user satisfaction.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Performance Monitoring and Analytics", "description": "Utilize performance monitoring tools and analytics to assess the effectiveness of IT infrastructure. This sub-capability involves setting KPIs, collecting data, and analyzing results to drive continuous improvement in IT service delivery and infrastructure reliability.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Vendor and Contract Management", "description": "Manage relationships and contracts with external vendors providing IT services and solutions. This sub-capability ensures that vendor performance aligns with the bank's strategic goals, optimizing value while minimizing risk.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Financial Services Delivery", "description": "Provide a wide range of banking products including loans, mortgages, accounts, and investment solutions to meet diverse customer financial needs.", "children": [{"name": "Personal Banking Services", "description": "Offer a comprehensive range of personal banking products including checking accounts, savings accounts, personal loans, and credit cards to enhance customer financial management and satisfaction.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Mortgage Services", "description": "Provide mortgage products tailored to various customer segments, facilitating home ownership through personalized mortgage solutions, competitive rates, and guidance through the application process.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Investment Products Management", "description": "Develop and manage a diverse suite of investment products such as mutual funds, stocks, and bonds, aimed at helping clients grow their wealth and achieve their financial goals.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Business Banking Solutions", "description": "Deliver banking services specifically designed for businesses, including business accounts, loans for operational needs, and tailored financial advice to support business growth.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Wealth Management Services", "description": "Offer personalized wealth management and financial advisory services to high-net-worth individuals, focusing on investment strategy, estate planning, and risk management.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Financial Planning Services", "description": "Provide financial planning expertise to assist customers in setting and achieving their financial objectives through tailored strategies and budgeting tools.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Support and Advisory", "description": "Deliver exceptional customer support and advisory services across all product lines, ensuring clients receive personalized assistance with their financial decisions.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Digital Banking Solutions", "description": "Enable customers to access banking services digitally through online and mobile platforms, providing convenience and enhancing user experience in managing finances.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Payment Solutions", "description": "Develop and maintain various payment solutions, including digital wallets, online payment processing, and transaction services, to facilitate seamless financial transactions for customers.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Card Services Management", "description": "Manage the issuance and servicing of debit, credit, and prepaid cards, focusing on security, customer experience, and innovative features to meet customer needs.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Strategic Financial Planning", "description": "Develop and manage the bank's financial strategies, including budgeting, forecasting, and financial performance analysis.", "children": [{"name": "Financial Budgeting", "description": "Manage the preparation and approval of the bank's annual budgets, ensuring resource allocation aligns with strategic goals and financial priorities. This sub-capability provides a structured approach to funding decision-making, promoting accountability and transparency.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Financial Forecasting", "description": "Conduct quantitative and qualitative analysis to project the bank's future financial performance based on historical data, market trends, and operational plans. This enables proactive decision-making and helps anticipate potential financial challenges before they arise.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Performance Analysis", "description": "Evaluate and assess the bank's financial performance by comparing actual results against budgets and forecasts to inform strategic adjustments. This sub-capability helps highlight areas of strength and opportunities for improvement, ensuring resources are utilized effectively.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Financial Risk Assessment", "description": "Identify and quantify the financial risks associated with the bank\u2019s strategies and operations, enabling informed decision-making and risk mitigation. This sub-capability supports the bank's overall risk management efforts by integrating financial perspectives into the risk evaluation process.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Capital Structure Management", "description": "Manage the bank's capital structure, including equity and debt financing strategies, to optimize financial performance and ensure adequate funding for strategic initiatives. This sub-capability ensures that the bank maintains a healthy balance sheet and meets regulatory requirements.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Cost Management Strategies", "description": "Develop and implement strategies for managing and reducing operational costs without compromising service quality or innovation. This supports the bank\u2019s financial health by enhancing profitability through efficient cost control measures.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Investment Strategy Development", "description": "Formulate and oversee investment strategies for the bank\u2019s portfolios, ensuring alignment with overall financial goals and risk appetites. This sub-capability contributes to the growth and sustainability of the bank's assets.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Financial Reporting and Compliance", "description": "Ensure accurate and timely financial reporting in compliance with regulatory standards and internal policies, enhancing transparency and stakeholder trust. This sub-capability supports strategic decision-making by providing reliable financial information.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Strategic Scenario Planning", "description": "Develop and evaluate multiple financial scenarios to assess potential impacts on the bank\u2019s performance under different economic conditions. This proactive approach enables the bank to adapt its strategies effectively in response to changing circumstances.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Stakeholder Engagement in Financial Strategy", "description": "Facilitate engagement with key internal and external stakeholders to align financial strategies with broader business objectives and gain insights for continuous improvement. This sub-capability enhances collaboration and strengthens the strategic alignment of financial planning efforts.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Digital Transformation", "description": "Drive the adoption of digital technologies and practices to enhance operational efficiency and improve customer experiences.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Compliance and Regulatory Management", "description": "Ensure adherence to local and international regulations and standards across all banking operations to maintain transparency and trust.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Sustainability Initiatives", "description": "Implement environmentally responsible practices and financial solutions that align with sustainable development goals and address ESG factors.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Investor Relations Management", "description": "Communicate effectively with current and potential investors by providing transparent information regarding financial performance, strategies, and shareholder value.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Talent Management and Development", "description": "Manage recruitment, training, and development programs to build a skilled workforce that supports the bank's strategic objectives.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Sales and Distribution Strategy", "description": "Develop and execute effective sales and distribution strategies across various channels to optimize market reach and profitability.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Marketing and Brand Management", "description": "Create and implement marketing strategies that enhance the bank's brand and support customer acquisition through targeted campaigns.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Customer Onboarding", "description": "Facilitate smooth and efficient onboarding processes for new customers, ensuring compliance and satisfaction from the outset.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Innovation Management", "description": "Foster a culture of innovation by encouraging idea generation, experimentation, and the implementation of new solutions within the bank.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Data Analytics and Insights", "description": "Utilize data analytics to gain insights into customer behaviors and market trends, informing strategic decision-making and product improvements.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Service Operations Management", "description": "Oversee the delivery of customer service across various channels, ensuring quality and consistency in service provision.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Partnership and Alliance Management", "description": "Manage relationships with strategic partners and alliances to enhance product offerings and expand market presence.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Core Banking Operations", "description": "Manage the bank's core banking systems and processes that support transactions, account management, and financial reporting.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}, {"name": "Corporate Social Responsibility", "description": "Integrate social responsibility initiatives into business practices, focusing on community engagement and support for social causes.", "children": null, "x": 0, "y": 0, "width": 120, "height": 60}], "x": 0, "y": 0, "width": 120, "height": 60};

        function calculateNodeSize(node) {
            if (!node.children || node.children.length === 0) {
                return {
                    width: BOX_MIN_WIDTH,
                    height: BOX_MIN_HEIGHT
                };
            }

            const childSizes = node.children.map(calculateNodeSize);

            let bestLayout = {
                rows: 1,
                cols: node.children.length,
                width: 0,
                height: 0,
                deviation: Infinity,
                positions: []
            };

            for (let rows = 1; rows <= node.children.length; rows++) {
                const cols = Math.ceil(node.children.length / rows);
                
                let rowHeights = new Array(rows).fill(0);
                let colWidths = new Array(cols).fill(0);
                
                for (let i = 0; i < node.children.length; i++) {
                    const row = Math.floor(i / cols);
                    const col = i % cols;
                    const size = childSizes[i];
                    
                    rowHeights[row] = Math.max(rowHeights[row], size.height);
                    colWidths[col] = Math.max(colWidths[col], size.width);
                }
                
                const gridWidth = colWidths.reduce((a, b) => a + b, 0) + (cols - 1) * HORIZONTAL_GAP;
                const gridHeight = rowHeights.reduce((a, b) => a + b, 0) + (rows - 1) * VERTICAL_GAP;
                
                const totalWidth = gridWidth + 2 * PADDING;
                const totalHeight = gridHeight + 2 * PADDING;
                const aspectRatio = totalWidth / totalHeight;
                const deviation = Math.abs(aspectRatio - DEFAULT_TARGET_ASPECT_RATIO);

                const positions = [];
                let yOffset = PADDING;
                
                for (let row = 0; row < rows; row++) {
                    let xOffset = PADDING;
                    for (let col = 0; col < cols; col++) {
                        const index = row * cols + col;
                        if (index < node.children.length) {
                            positions[index] = {
                                x: xOffset,
                                y: yOffset,
                                width: colWidths[col],
                                height: rowHeights[row]
                            };
                        }
                        xOffset += colWidths[col] + HORIZONTAL_GAP;
                    }
                    yOffset += rowHeights[row] + VERTICAL_GAP;
                }

                if (deviation < bestLayout.deviation) {
                    bestLayout = {
                        rows,
                        cols,
                        width: totalWidth,
                        height: totalHeight,
                        deviation,
                        positions
                    };
                }
            }

            return bestLayout;
        }

        function layoutTree(node, x = 0, y = 0) {
            const layout = calculateNodeSize(node);
            node.x = x;
            node.y = y;
            node.width = layout.width;
            node.height = layout.height;

            if (node.children && node.children.length > 0) {
                node.children.forEach((child, i) => {
                    const pos = layout.positions[i];
                    layoutTree(
                        child,
                        x + pos.x,
                        y + pos.y
                    );
                    child.width = pos.width;
                    child.height = pos.height;
                });
            }

            return node;
        }

        function createSVGElement(tagName, attributes = {}) {
            const element = document.createElementNS("http://www.w3.org/2000/svg", tagName);
            Object.entries(attributes).forEach(([key, value]) => {
                element.setAttribute(key, value);
            });
            return element;
        }

        function wrapText(text, width) {
            const words = text.split(' ');
            const lines = [];
            let currentLine = words[0];

            // Create temporary SVG to measure text
            const svg = createSVGElement('svg');
            const tempText = createSVGElement('text', {
                'font-size': '0.875rem',
                'font-family': 'system-ui, -apple-system, sans-serif'
            });
            svg.appendChild(tempText);
            document.body.appendChild(svg);

            for (let i = 1; i < words.length; i++) {
                tempText.textContent = currentLine + ' ' + words[i];
                const textWidth = tempText.getComputedTextLength();

                if (textWidth < width - 20) {  // 20px padding
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);

            document.body.removeChild(svg);
            return lines;
        }

        function renderNode(node) {
            const group = createSVGElement("g");

            // Add tooltip to group
            if (node.description) {
                const groupTitle = createSVGElement("title");
                groupTitle.textContent = `${node.name}\n${node.description}`;
                group.appendChild(groupTitle);
            }

            const rect = createSVGElement("rect", {
                x: node.x,
                y: node.y,
                width: node.width,
                height: node.height,
                fill: node.children?.length ? "#f8fafc" : "#fff",
                stroke: "#475569",
                "stroke-width": "1",
                rx: "4"
            });
            
            // Add same tooltip to rectangle
            if (node.description) {
                const rectTitle = createSVGElement("title");
                rectTitle.textContent = `${node.name}\n${node.description}`;
                rect.appendChild(rectTitle);
            }
            
            group.appendChild(rect);

            // Wrap text and create multiple text lines
            const lines = wrapText(node.name, node.width);
            const totalTextHeight = lines.length * LINE_HEIGHT;
            const startY = node.children?.length ? 
                node.y + PADDING_TOP : 
                node.y + (node.height - totalTextHeight) / 2;

            lines.forEach((line, index) => {
                const text = createSVGElement("text", {
                    x: node.x + node.width / 2,
                    y: startY + (index * LINE_HEIGHT),
                    "text-anchor": "middle",
                    "dominant-baseline": "hanging"
                });
                text.textContent = line;
                group.appendChild(text);
            });

            if (node.children) {
                node.children.forEach(child => {
                    group.appendChild(renderNode(child));
                });
            }

            return group;
        }

        function init() {
            const layoutedTree = layoutTree(JSON.parse(JSON.stringify(capabilityModel)));
            
            const svg = createSVGElement("svg", {
                width: layoutedTree.width + 40,
                height: layoutedTree.height + 40,
                viewBox: `0 0 ${layoutedTree.width + 40} ${layoutedTree.height + 40}`,
                class: "bg-white"
            });

            svg.appendChild(renderNode(layoutedTree));
            document.getElementById("svg-container").appendChild(svg);
        }

        // Initialize when the page loads
        document.addEventListener("DOMContentLoaded", init);
    </script>
</body>
</html>